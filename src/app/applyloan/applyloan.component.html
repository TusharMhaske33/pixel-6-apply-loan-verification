<div class="content" role="main">

    <ng-container *ngIf="!pageModel.isVerificationSuccess;else showVerifiedSuccess">
        <div class="card highlight-card card-small">
            <span>Apply for loan</span>
        </div>
        <div class="card-container">
            <div class="card">
                <form (ngSubmit)="registerUser()" [formGroup]="registerFrm">
                    <div class="form-group">
                        <label for="city">City :<small>(<i class="isRequiredAsterik">*</i>)</small></label>
                        <input type="text"
                            [ngClass]="{'invalid': (pageModel.isFormSubmited || regFrm.city.touched) && regFrm.city.invalid }"
                            class="form-control" id="city" formControlName="city">
                        <div class="error-container"
                            *ngIf="(pageModel.isFormSubmited || regFrm.city.touched) && regFrm.city.invalid">
                            <div class="error-message">
                                <span *ngIf="regFrm.city.errors?.required">City is required</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="panNumber">PAN Number : <small> (<i class="isRequiredAsterik">*</i>)</small>
                        </label>
                        <input type="text"
                            [ngClass]="{'invalid': (pageModel.isFormSubmited || regFrm.panNumber.touched) && regFrm.panNumber.invalid }"
                            class="form-control" id="panNumber" formControlName="panNumber">
                        <div class="error-container"
                            *ngIf="(pageModel.isFormSubmited || regFrm.panNumber.touched) && regFrm.panNumber.invalid">
                            <div class="error-message">
                                <span *ngIf="regFrm.panNumber.errors?.required">PAN Number is required</span>
                                <span *ngIf="!regFrm.panNumber.errors?.required && regFrm.panNumber.errors?.pattern">
                                    Invalid format for PAN Number</span>
                                <span *ngIf="!regFrm.panNumber.errors?.pattern && regFrm.panNumber.errors?.maxlength">
                                    Maximum of 10 digits allowed
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="fullname">Full Name :<small>(<i class="isRequiredAsterik">*</i>)</small></label>
                        <input type="fullname"
                            [ngClass]="{'invalid': (pageModel.isFormSubmited || regFrm.fullname.touched) && regFrm.fullname.invalid }"
                            class="form-control" id="fullname" formControlName="fullname">
                        <div class="error-container"
                            *ngIf="(pageModel.isFormSubmited || regFrm.fullname.touched) && regFrm.fullname.invalid">
                            <div class="error-message">
                                <span *ngIf="regFrm.fullname.errors?.required">Full Name is required</span>
                                <span *ngIf="!regFrm.fullname.errors?.pattern && regFrm.fullname.errors?.maxlength">
                                    Maximum of 140 digits allowed
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="email">Email address :<small>(<i class="isRequiredAsterik">*</i>)</small></label>
                        <input type="email"
                            [ngClass]="{'invalid': (pageModel.isFormSubmited || regFrm.email.touched) && regFrm.email.invalid }"
                            class="form-control" id="email" formControlName="email">
                        <div class="error-container"
                            *ngIf="(pageModel.isFormSubmited || regFrm.email.touched) && regFrm.email.invalid">
                            <div class="error-message">
                                <span *ngIf="regFrm.email.errors?.required">Email is required</span>
                                <span *ngIf="!regFrm.email.errors?.required && regFrm.email.errors?.email">
                                    Please enter valid email</span>
                                <span *ngIf="!regFrm.email.errors?.email && regFrm.email.errors?.maxlength">
                                    Maximum of 255 digits allowed
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="mobile">Mobile number :<small>(<i class="isRequiredAsterik">*</i>)</small></label>
                        <div class="mobile-number">
                            <span class="c-code">+91</span>
                            <input type="text" (change)="onChangeMobile()"
                                [ngClass]="{'invalid': (pageModel.isFormSubmited || regFrm.mobile.touched) && regFrm.mobile.invalid }"
                                class="form-control" id="mobile" formControlName="mobile">
                        </div>
                        <div class="error-container"
                            *ngIf="(pageModel.isFormSubmited || regFrm.mobile.touched) && regFrm.mobile.invalid">
                            <div class="error-message">
                                <span *ngIf="regFrm.mobile.errors?.required">
                                    Mobile Number is required.
                                </span>
                                <span *ngIf="!regFrm.mobile.errors?.pattern && regFrm.mobile.errors?.maxlength">
                                    Maximum of 10 digits allowed
                                </span>
                                <span *ngIf="regFrm.mobile.errors?.pattern">
                                    Invalid format for mobile number
                                </span>
                            </div>
                        </div>
                    </div>

                    <ng-container *ngIf="pageModel.isOtpSendSuccess">
                        <div class="form-group">
                            <label for="otp">Enter OTP :
                                <small>(<i class="isRequiredAsterik">*</i>) </small>
                            </label>
                            <input type="text" (change)="verifyOtp()"
                                [ngClass]="{'invalid': (pageModel.isOtpSubmited || regFrm.otp.touched) && regFrm.otp.invalid }"
                                class="form-control" id="otp" formControlName="otp">
                            <div class="error-container"
                                *ngIf="(pageModel.isOtpSubmited || regFrm.otp.touched) && regFrm.otp.invalid">
                                <div class="error-message">
                                    <span *ngIf="regFrm.otp.errors?.required">OTP is required</span>
                                    <span *ngIf="!regFrm.otp.errors?.required && regFrm.otp.errors?.pattern">
                                        Enter valid OTP</span>
                                    <span *ngIf="!regFrm.otp.errors?.pattern && regFrm.otp.errors?.maxlength">
                                        Maximum of 4 digits allowed
                                    </span>
                                    <span *ngIf="!regFrm.otp.errors?.pattern && regFrm.otp.errors?.minlength">
                                        Minimum 4 digits required
                                    </span>
                                </div>
                            </div>
                        </div>
                        <ng-container *ngIf="!!pageModel.otpElapsedTime; else showResendOpt">
                            <span class="resendOption"> Resend OTP in  {{ pageModel.otpElapsedTime }} min </span>
                        </ng-container>
                        <ng-template #showResendOpt>
                            <span class="resendOption">
                                <a href="javascript:void(0);" (click)="sendOtp()">Resend OTP ?</a>
                            </span>
                        </ng-template>
                    </ng-container>
                </form>
            </div>
        </div>
    </ng-container>
    <ng-template #showVerifiedSuccess>
        <div class="card highlight-card card-small">
            <span>Application send succeffully</span>
        </div>
        <p>Thanks you for verification {{regFrm.fullname.value}}</p>
    </ng-template>
</div>